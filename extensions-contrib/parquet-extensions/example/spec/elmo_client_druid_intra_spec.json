{
  "type":"index_hadoop",
  "spec":{
    "dataSchema":{
      "dataSource":"elmo_client",
      "parser":{
        "type":"parquet",
        "binaryAsString":true,
        "parquetParser":{
          "fields":[
            {
              "rootFieldName":"headers",
              "key":"ts_message_create",
              "fieldType":"UNION",
              "field":{
                "key":"member1",
                "rootFieldName":"member1",
                "fieldType":"MAP"
              },
              "dimensionName":"timestamp"
            },
            {
              "rootFieldName":"",
              "index":-1,
              "key":"experiencedExperiments",
              "fieldType":"STRING"
            },
            {
              "rootFieldName":"",
              "index":-1,
              "key":"experiencedTreatments",
              "fieldType":"STRING"
            },
            {
              "rootFieldName":"",
              "index":-1,
              "key":"experimentVersions",
              "fieldType":"STRING"
            },
            {
              "rootFieldName":"",
              "index":-1,
              "key":"treatmentVersions",
              "fieldType":"STRING"
            },
            {
              "rootFieldName":"data",
              "index":-1,
              "key":"fpti",
              "dimensionName":"cookie_id",
              "fieldType":"MAP"
            },
            {
              "rootFieldName":"data",
              "index":-1,
              "key":"vid",
              "dimensionName":"visit_id",
              "fieldType":"MAP"
            },
            {
              "rootFieldName":"data",
              "index":-1,
              "key":"decr_merchant_account_number",
              "dimensionName":"decr_merchant_account_number",
              "fieldType":"MAP"
            },
            {
              "rootFieldName":"data",
              "index":-1,
              "key":"decr_transaction_id",
              "dimensionName":"decr_transaction_id",
              "fieldType":"MAP"
            },
            {
              "rootFieldName":"",
              "index":-1,
              "key":"decr_account_number",
              "dimensionName":"customerId",
              "fieldType":"STRING"
            },
            {
              "rootFieldName":"data",
              "index":-1,
              "key":"rsta",
              "dimensionName":"language_id",
              "fieldType":"MAP"
            },
            {
              "rootFieldName":"data",
              "index":-1,
              "key":"loca",
              "dimensionName":"locale",
              "fieldType":"MAP"
            },
            {
              "rootFieldName":"data",
              "index":-1,
              "key":"component",
              "dimensionName":"component_name",
              "fieldType":"MAP"
            },
            {
              "rootFieldName":"data",
              "index":-1,
              "key":"page",
              "dimensionName":"page_name",
              "fieldType":"MAP"
            },
            {
              "rootFieldName":"data",
              "index":-1,
              "key":"pgrp",
              "dimensionName":"page_group",
              "fieldType":"MAP"
            },
            {
              "rootFieldName":"data",
              "index":-1,
              "key":"osv",
              "dimensionName":"os_version",
              "fieldType":"MAP"
            },
            {
              "rootFieldName":"data",
              "index":-1,
              "key":"os",
              "dimensionName":"page_name",
              "fieldType":"MAP"
            },
            {
              "rootFieldName":"data",
              "index":-1,
              "key":"bver",
              "dimensionName":"browser_version",
              "fieldType":"MAP"
            },
            {
              "rootFieldName":"data",
              "index":-1,
              "key":"btyp",
              "dimensionName":"browser_type",
              "fieldType":"MAP"
            },
            {
              "rootFieldName":"data",
              "index":-1,
              "key":"acnt",
              "dimensionName":"account_type",
              "fieldType":"MAP"
            },
            {
              "rootFieldName":"data",
              "index":-1,
              "key":"dvid",
              "dimensionName":"device_id",
              "fieldType":"MAP"
            },
            {
              "rootFieldName":"data",
              "index":-1,
              "key":"dvis",
              "dimensionName":"device",
              "fieldType":"MAP"
            },
            {
              "rootFieldName":"data",
              "index":-1,
              "key":"lgin",
              "dimensionName":"user_logged_in",
              "fieldType":"MAP"
            },
            {
              "rootFieldName":"geo",
              "index":-1,
              "key":"country_iso_code",
              "dimensionName":"country_iso_code",
              "fieldType":"MAP"
            },
            {
              "rootFieldName":"geo",
              "index":-1,
              "key":"country_name",
              "dimensionName":"country_name",
              "fieldType":"MAP"
            },
            {
              "rootFieldName":"geo",
              "index":-1,
              "key":"continent",
              "dimensionName":"continent",
              "fieldType":"MAP"
            },
            {
              "rootFieldName":"geo",
              "index":-1,
              "key":"region",
              "dimensionName":"region",
              "fieldType":"MAP"
            },
            {
              "rootFieldName":"geo",
              "index":-1,
              "key":"region_code",
              "dimensionName":"region_code",
              "fieldType":"MAP"
            },
            {
              "rootFieldName":"geo",
              "index":-1,
              "key":"subdivision_name",
              "dimensionName":"subdivision_name",
              "fieldType":"MAP"
            },
            {
              "rootFieldName":"geo",
              "index":-1,
              "key":"city_name",
              "dimensionName":"city_name",
              "fieldType":"MAP"
            },
            {
              "rootFieldName":"geo",
              "index":-1,
              "key":"postal_code",
              "dimensionName":"postal_code",
              "fieldType":"MAP"
            },
            {
              "rootFieldName":"geo",
              "index":-1,
              "key":"longitude",
              "dimensionName":"longitude",
              "fieldType":"MAP"
            },
            {
              "rootFieldName":"geo",
              "index":-1,
              "key":"latitude",
              "dimensionName":"latitude",
              "fieldType":"MAP"
            },
            {
              "rootFieldName":"data",
              "index":-1,
              "key":"channel",
              "dimensionName":"channel",
              "fieldType":"MAP"
            },
            {
              "rootFieldName":"data",
              "index":-1,
              "key":"chnl",
              "dimensionName":"channel_defined",
              "fieldType":"MAP"
            },
            {
              "rootFieldName":"data",
              "index":-1,
              "key":"bot",
              "dimensionName":"bot",
              "fieldType":"MAP"
            },
            {
              "rootFieldName":"data",
              "index":-1,
              "key":"enrich",
              "dimensionName":"enrich",
              "fieldType":"MAP"
            },
            {
              "rootFieldName":"data",
              "index":-1,
              "key":"sw",
              "dimensionName":"screen_width",
              "fieldType":"MAP"
            },
            {
              "rootFieldName":"data",
              "index":-1,
              "key":"sh",
              "dimensionName":"screen_height",
              "fieldType":"MAP"
            },
            {
              "rootFieldName":"data",
              "index":-1,
              "key":"dw",
              "dimensionName":"device_width",
              "fieldType":"MAP"
            },
            {
              "rootFieldName":"data",
              "index":-1,
              "key":"dh",
              "dimensionName":"device_height",
              "fieldType":"MAP"
            },
            {
              "rootFieldName":"data",
              "index":-1,
              "key":"e",
              "dimensionName":"event_type",
              "fieldType":"MAP"
            },
            {
              "rootFieldName":"data",
              "index":-1,
              "key":"pgln",
              "dimensionName":"page_name_link",
              "fieldType":"MAP"
            },
            {
              "rootFieldName":"data",
              "index":-1,
              "key":"pglk",
              "dimensionName":"page_group_link",
              "fieldType":"MAP"
            },
            {
              "rootFieldName":"data",
              "index":-1,
              "key":"guser",
              "dimensionName":"isp_user_type",
              "fieldType":"MAP"
            },
            {
              "rootFieldName":"data",
              "index":-1,
              "key":"gisp",
              "dimensionName":"isp_name",
              "fieldType":"MAP"
            },
            {
              "rootFieldName":"data",
              "index":-1,
              "key":"gconn",
              "dimensionName":"connection_type",
              "fieldType":"MAP"
            },
            {
              "rootFieldName":"data",
              "index":-1,
              "key":"mobile_device_model",
              "dimensionName":"device_model",
              "fieldType":"MAP"
            },
            {
              "rootFieldName":"data",
              "index":-1,
              "key":"mdvs",
              "dimensionName":"mobile_device_name",
              "fieldType":"MAP"
            },
            {
              "rootFieldName":"data",
              "index":-1,
              "key":"mobile_operating_system",
              "dimensionName":"mobile_os",
              "fieldType":"MAP"
            },
            {
              "rootFieldName":"data",
              "index":-1,
              "key":"mobile_carrier",
              "dimensionName":"mobile_carrier",
              "fieldType":"MAP"
            },
            {
              "rootFieldName":"data",
              "index":-1,
              "key":"total_page_load_time",
              "dimensionName":"total_page_load_time",
              "fieldType":"MAP"
            },
            {
              "rootFieldName":"data",
              "index":-1,
              "key":"total_page_load_time",
              "dimensionName":"page_load_time",
              "fieldType":"MAP"
            },
            {
              "rootFieldName":"data",
              "index":-1,
              "key":"xhr_load_time",
              "dimensionName":"xhr_load_time",
              "fieldType":"MAP"
            },
            {
              "rootFieldName":"data",
              "index":-1,
              "key":"othr_load_time",
              "dimensionName":"othr_load_time",
              "fieldType":"MAP"
            },
            {
              "rootFieldName":"data",
              "index":-1,
              "key":"scr_load_time",
              "dimensionName":"scr_load_time",
              "fieldType":"MAP"
            },
            {
              "rootFieldName":"data",
              "index":-1,
              "key":"img_load_time",
              "dimensionName":"img_load_time",
              "fieldType":"MAP"
            },
            {
              "rootFieldName":"data",
              "index":-1,
              "key":"css_load_time",
              "dimensionName":"css_load_time",
              "fieldType":"MAP"
            }
          ]
        },
        "parseSpec":{
          "format":"timeAndDims",
          "timestampSpec":{
            "column":"timestamp",
            "format":"millis"
          },
          "dimensionsSpec":{
            "dimensions":[
              "experiencedExperiments",
              "experiencedTreatments",
              "experimentVersions",
              "treatmentVersions",
              "language_id",
              "locale",
              "component_name",
              "page_name",
              "page_group",
              "os_version",
              "os",
              "browser_version",
              "browser_type",
              "account_type",
              "device_id",
              "device",
              "user_logged_in",
              "country_iso_code",
              "country_name",
              "continent",
              "region",
              "region_code",
              "subdivision_name",
              "city_name",
              "postal_code",
              "channel",
              "channel_defined",
              "bot",
              "enrich",
              "event_type",
              "page_name_link",
              "page_group_link",
              "isp_user_type",
              "isp_name",
              "connection_type",
              "device_model",
              "mobile_device_name",
              "mobile_operating_system",
              "mobile_carrier",
              "total_page_load_time",
              "page_load_time",
              "xhr_load_time",
              "othr_load_time",
              "scr_load_time",
              "img_load_time",
              "css_load_time",
              "screen_width",
              "screen_height",
              "device_width",
              "device_height",
              "longitude",
              "latitude"
            ],
            "dimensionExclusions":[

            ],
            "spatialDimensions":[
              {
                "dimName":"screen_dimension",
                "dims":[
                  "screen_width",
                  "screen_height"
                ]
              },
              {
                "dimName":"device_dimension",
                "dims":[
                  "device_width",
                  "device_height"
                ]
              },
              {
                "dimName":"geo_coordinates",
                "dims":[
                  "longitude",
                  "latitude"
                ]
              }
            ]
          }
        }
      },
      "metricsSpec":[
        {
          "type":"count",
          "name":"count"
        },
        {
          "type":"hyperUnique",
          "name":"dist_visits",
          "fieldName":"visit_id"
        },
        {
          "type":"hyperUnique",
          "name":"dist_visitors",
          "fieldName":"cookie_id"
        },
        {
          "type":"hyperUnique",
          "name":"dist_users",
          "fieldName":"customerId"
        },
        {
          "type":"hyperUnique",
          "name":"dist_merchants",
          "fieldName":"decr_merchant_account_number"
        },
        {
          "type":"hyperUnique",
          "name":"dist_transactions",
          "fieldName":"decr_transaction_id"
        }
      ],
      "granularitySpec":{
        "type":"uniform",
        "segmentGranularity":"HOUR",
        "queryGranularity":"None",
        "intervals":[
          "2017-09-07T20:00:00.000Z/2017-09-08T10:00:00.000Z"
        ]
      }
    },
    "ioConfig":{
      "type":"hadoop",
      "inputSpec":{
        "type":"static",
        "inputFormat":"io.druid.data.input.parquet.DruidParquetInputFormat",
        "paths": "example/events/elmo_client/part-11877-db38f46b-772b-4670-b88f-059f975c7c74.snappy.parquet"
      },
      "segmentOutputPath": "/tmp/segments"
    },
    "tuningConfig": {
      "type": "hadoop",
      "workingPath": "tmp/working_path",
      "version": "2017-02-09T07:36:09.249Z",
      "partitionsSpec": {
        "type": "hashed",
        "targetPartitionSize": 750000,
        "maxPartitionSize": 750000,
        "assumeGrouped": false,
        "numShards": -1,
        "partitionDimensions": [
        ]
      },
      "shardSpecs": {
      },
      "indexSpec": {
        "bitmap": {
          "type": "concise"
        },
        "dimensionCompression": "lz4",
        "metricCompression": "lz4",
        "longEncoding": "longs"
      },
      "maxRowsInMemory": 75000,
      "leaveIntermediate": true,
      "cleanupOnFailure": true,
      "overwriteFiles": false,
      "ignoreInvalidRows": false,
      "jobProperties": {
        "hdp.version": "2.5.3.58-3",
        "mapreduce.job.user.classpath.first": "true",
        "mapreduce.task.timeout": "1800000",
        "mapreduce.map.memory.mb": "2048",
        "mapreduce.map.java.opts": "-server -Xmx3072m -Duser.timezone=UTC -Dfile.encoding=UTF-8",
        "mapreduce.reduce.memory.mb": "2048",
        "mapreduce.reduce.java.opts": "-server -Xmx8192m -Duser.timezone=UTC -Dfile.encoding=UTF-8",
        "mapreduce.job.queuename": "experimentation",
        "mapred.child.ulimit": "16777216",
        "mapreduce.map.output.compress": "true",
        "mapred.map.output.compress.codec": "org.apache.hadoop.io.compress.GzipCodec"
      },
      "combineText": false,
      "useCombiner": false,
      "buildV9Directly": false,
      "numBackgroundPersistThreads": 0,
      "forceExtendableShardSpecs": false
    },
    "uniqueId": "715f31321096480b869aca2cc9c5d252"
  },
  "hadoopDependencyCoordinates": [
    "org.apache.hadoop:hadoop-client:2.6.0"
  ]
}